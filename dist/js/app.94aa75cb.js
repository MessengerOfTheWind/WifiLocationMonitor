(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(t,e,a){t.exports=a("56d7")},"05ea":function(t,e,a){"use strict";a("1473")},1395:function(t,e,a){},1473:function(t,e,a){},"1abf":function(t,e,a){},"1cf7":function(t,e,a){},"2c01":function(t,e,a){t.exports=a.p+"img/firstFloor1.89f244a9.svg"},"2fb8":function(t,e,a){},3232:function(t,e,a){"use strict";a("37b0")},"37b0":function(t,e,a){},"3e0c":function(t,e,a){"use strict";a("1abf")},"3e3d":function(t,e,a){"use strict";a("aaf0")},"3eab":function(t,e,a){"use strict";a("1cf7")},4886:function(t,e,a){"use strict";a("2fb8")},"55b3":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("datav")],1)},i=[],o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"data-view"}},[e("dv-full-screen-container",[e("div",{staticClass:"main-header"},[e("div",{staticClass:"mh-left"}),e("div",{staticClass:"mh-middle"},[t._v("室内人员定位分布")]),e("div",{staticClass:"mh-right"},[e("dv-border-box-2",{staticStyle:{width:"120px",height:"50px","line-height":"50px","text-align":"center","margin-left":"200px"}},[t._v("\n          综合管理台\n        ")])],1)]),e("dv-border-box-1",{staticClass:"main-container"},[e("dv-border-box-3",{staticClass:"left-chart-container"},[e("person-distribute-pie"),e("person-distribute-excel")],1),e("div",{staticClass:"right-main-container"},[e("div",{staticClass:"rmc-top-container"},[e("dv-border-box-3",{staticClass:"rmctc-left-container"},[e("Center-Cmp")],1),e("div",{staticClass:"rmctc-right-container"},[e("dv-border-box-3",{staticClass:"rmctc-chart-1"},[e("person-density")],1),e("dv-border-box-4",{staticClass:"rmctc-chart-2",attrs:{reverse:!0}},[e("top-right-cmp")],1)],1)],1),e("dv-border-box-4",{staticClass:"rmc-bottom-container"},[e("Bottom-Charts")],1)],1)],1)],1)],1)},s=[],c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"center-cmp"},[e("div",{staticClass:"cc-header"},[e("dv-decoration-1",{staticStyle:{width:"200px",height:"50px"}}),e("div",{staticClass:"dropdown"},[e("el-select",{attrs:{placeholder:"选择区域"},on:{change:t.updateComponent},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.areaName,value:t.value}})})),1)],1),e("dv-decoration-1",{staticStyle:{width:"200px",height:"50px"}})],1),e("div",{staticClass:"cc-details"},[e(t.value,{tag:"component"})],1)])},u=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"label-tag"},[t.mergedConfig?t._l(t.mergedConfig.data,(function(a,n){return e("div",{key:a,staticClass:"label-item"},[t._v("\n      "+t._s(a)+" "),e("div",{style:"background-color: ".concat(t.mergedConfig.colors[n%t.mergedConfig.colors.length],";")})])})):t._e()],2)},f=[],d=a("becb"),h=a("5557"),p={name:"LabelTag",props:{config:{type:Object,default:function(){return[]}}},data:function(){return{defaultConfig:{data:[],colors:["#00baff","#3de7c9","#fff","#ffc530","#469f4b"]},mergedConfig:null}},watch:{config:function(){var t=this.mergeConfig;t()}},methods:{mergeConfig:function(){var t=this.config,e=this.defaultConfig;this.mergedConfig=Object(d["deepMerge"])(Object(h["deepClone"])(e,!0),t||{})}},mounted:function(){var t=this.mergeConfig;t()}},v=p,g=(a("05ea"),a("2877")),m=Object(g["a"])(v,l,f,!1,null,null,null),b=m.exports,C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container",on:{mousedown:t.startRotate,mouseup:t.endRotate,mouseleave:t.endRotate,mousemove:t.rotateBackground}},[e("div",{staticClass:"positioning",style:{transform:"rotateY(".concat(t.rotationY,"deg) rotateX(").concat(t.rotationX,"deg)")}},[e("svg",{staticClass:"background-svg",attrs:{preserveAspectRatio:"xMidYMid meet"}},[e("image",{staticClass:"img",attrs:{href:a("2c01")}}),t._l(t.positions,(function(a,n){return e("circle",{key:n,attrs:{cx:t.convertX(a.x),cy:t.convertY(a.y),r:"5",fill:"red"}})}))],2)])])},y=[],D=(a("28a5"),a("3835")),O=Object(n["reactive"])({PersonData:[]}),w={data:function(){return{svgWidth:0,svgHeight:0,realWidth:43.168,realHeight:31.247,isDragging:!1,lastX:0,lastY:0,rotationX:36.5,rotationY:-27,positions:[]}},methods:{setSvgDimensions:function(){var t=this.$el.querySelector(".background-svg");t&&(this.svgWidth=t.clientWidth,this.svgHeight=t.clientHeight)},convertX:function(t){return t/this.realWidth*this.svgWidth},convertY:function(t){return t/this.realHeight*this.svgHeight},parsePositions:function(t){return t.map((function(t){var e=t.userXyz.split(",").map((function(t){return parseFloat(t.trim())})),a=Object(D["a"])(e,2),n=a[0],r=a[1];return{x:n,y:r,userName:t.userName}}))},updatePersonLocation:function(t){var e=this.parsePositions(t);this.positions=e},startRotate:function(t){this.isDragging=!0,this.lastX=t.clientX,this.lastY=t.clientY},endRotate:function(){this.isDragging=!1},rotateBackground:function(t){if(this.isDragging){var e=t.clientX-this.lastX,a=t.clientY-this.lastY;this.rotationY+=.5*e,this.rotationX-=.5*a,this.lastX=t.clientX,this.lastY=t.clientY}}},mounted:function(){var t=this;this.setSvgDimensions(),setTimeout((function(){Array.isArray(O.PersonData)&&O.PersonData.length>0&&t.updatePersonLocation(O.PersonData),t.intervalId=setInterval((function(){t.updatePersonLocation(O.PersonData)}),1e4)}),1e3)},watch:{svgWidth:function(){this.updatePersonLocation(O.PersonData)},svgHeight:function(){this.updatePersonLocation(O.PersonData)}}},P=w,x=(a("3232"),Object(g["a"])(P,C,y,!1,null,null,null)),j=x.exports,k=function(){var t=this,e=t._self._c;return e("div",[t._v("\n  ceshi\n")])},_=[],S={},N=Object(g["a"])(S,k,_,!1,null,null,null),M=N.exports,A={name:"CenterCmp",components:{LabelTag:b,PersonLocation:j,AreaExhibition:M},data:function(){return{areaName:"大厅",options:[{value:"person-location",areaName:"展厅"},{value:"area-exhibition",areaName:"客厅"}],value:"person-location",currentComponent:null}},methods:{updateComponent:function(t){this.currentComponent="person-location"===t?"PersonLocation":"area-exhibition"}},mounted:function(){console.log(22)}},L=A,I=(a("3e0c"),Object(g["a"])(L,c,u,!1,null,null,null)),W=I.exports,T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-chart-1"},[e("div",{staticClass:"lc1-header"},[t._v("人员分布")]),e("div",{staticClass:"lc1-details"},[t._v("\n    人员总数"),e("span",[t._v(t._s(t.personNum))])]),e("dv-charts",{staticClass:"lc2-chart",attrs:{id:"box",option:t.option}}),e("dv-decoration-2",{staticStyle:{height:"10px"}})],1)},Y=[],X=(a("ac6a"),a("456d"),a("313e")),E={name:"LeftChart1",data:function(){return{chart:null,personNum:0,option:{series:[{type:"pie",data:[],radius:["45%","65%"],padding:[5,10],label:{show:!0,formatter:"{b}: {c} ({d}%)"}}],color:["#00baff","#3de7c9","#fff","#ffc530","#469f4b"]}}},methods:{initializeChart:function(){this.chart=X["a"](document.querySelector("#box")),this.chart.setOption(this.option)},updateChart:function(t){var e=t.reduce((function(t,e){return t[e.areaName]=(t[e.areaName]||0)+1,t}),{}),a=Object.keys(e).map((function(t){return{name:t,value:e[t]}}));this.option.series[0].data=a,this.personNum=a.reduce((function(t,e){return t+e.value}),0),this.chart.setOption(this.option)}},mounted:function(){var t=this;setTimeout((function(){t.initializeChart(),Array.isArray(O.PersonData)&&O.PersonData.length>0&&t.updateChart(O.PersonData),t.intervalId=setInterval((function(){t.updateChart(O.PersonData)}),1e4)}),1e3)},beforeDestroy:function(){this.chart&&this.chart.dispose()}},R=E,H=(a("3e3d"),Object(g["a"])(R,T,Y,!1,null,null,null)),B=H.exports,z=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"scroll-board"}},[e("dv-scroll-board",{attrs:{id:"box",config:t.config}})],1)},F=[],q=(a("8e6e"),a("ade3"));function G(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function J(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?G(Object(a),!0).forEach((function(e){Object(q["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var $={name:"ScrollBoard",data:function(){return{config:{header:["姓名","区域","位置"],data:[],index:!0,columnWidth:[40,80,100],align:["center"],rowNum:8,headerBGC:"#1981f6",headerHeight:50,oddRowBGC:"rgba(0, 44, 81, 0.8)",evenRowBGC:"rgba(10, 29, 50, 0.8)"}}},methods:{updateChart:function(t){var e=[];t.forEach((function(t){var a=t.userName,n=t.areaName,r=t.userXyz.split(","),i="".concat(r[0].trim(),", ").concat(r[1].trim());e.push([a,n,i])})),this.config.data=e,this.config=J({},this.config)}},mounted:function(){var t=this;setTimeout((function(){Array.isArray(O.PersonData)&&O.PersonData.length>0&&t.updateChart(O.PersonData),t.intervalId=setInterval((function(){t.updateChart(O.PersonData)}),1e4)}),1e3)}},U=$,V=(a("3eab"),Object(g["a"])(U,z,F,!1,null,null,null)),K=V.exports,Q=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bottom-charts"},[e("div",{staticClass:"bc-chart-three-item"},[e("personnel-forecast")],1),e("div",{staticClass:"bc-chart-item"},[e("div",{staticClass:"bcci-header"},[t._v("1小时后人员统计")]),e("dv-active-ring-chart",{attrs:{config:t.config4}}),e("Label-Tag",{attrs:{config:t.labelConfig}})],1)])},Z=[],tt=function(){var t=this,e=t._self._c;return e("div",{ref:"chart",staticStyle:{width:"100%",height:"300px"}})},et=[],at=(a("7f7f"),a("6b54"),{data:function(){return{chart:null,groupedData:{},initData:[],areaData:[],areaCountMap:{},nowtime:{},oneDay:36e5,oneHour:36e5,numbers:[-1,-2,0,1,2]}},methods:{randomData:function(t){this.nowtime[t]=new Date(+this.nowtime[t]+this.oneHour);var e=Math.floor(Math.random()*this.numbers.length);this.areaCountMap[t]=this.areaCountMap[t]+this.numbers[e],this.areaCountMap[t]<0&&(this.areaCountMap[t]+=2);var a=this.nowtime[t];return{name:this.nowtime[t].toString(),value:[[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/")+" "+a.getHours()+":00",Math.round(this.areaCountMap[t])]}},initChart:function(){var t=this;this.areaCountMap=this.initData.reduce((function(t,e){return t[e.areaName]=(t[e.areaName]||0)+1,t}),{});var e=Object.keys(this.areaCountMap).map((function(e){return{areaName:e,value:t.areaCountMap[e]}}));this.areaData=e;var a=new Date;this.areaData.forEach((function(e){var n=e.areaName;t.groupedData[n]||(t.groupedData[n]=[]),t.nowtime[n]=new Date(a)})),this.chart=X["a"](this.$refs.chart);for(var n=0;n<10;n++)this.areaData.forEach((function(e){var a=e.areaName;t.groupedData[a].push(t.randomData(a))}));var r=["#ff5733","#33ff57","#3357ff","#ff33aa","#aaff33","#ff9933","#33ccff","#cc33ff","#ffcc33","#33ffaa","#ff3333","#33aaff","#aa33ff","#ff6633","#33ffcc"],i=Object.keys(this.groupedData).map((function(e,a){return{name:e,type:"line",showSymbol:!0,data:t.groupedData[e],lineStyle:{color:r[a%r.length]},textStyle:{color:"#fff"}}})),o={title:{text:"人员分布预测",textStyle:{color:"#fff",fontSize:30},left:"center"},legend:{top:"15%"},tooltip:{trigger:"axis",formatter:function(t){t=t[0];var e=new Date(t.name);return"".concat(e.getDate(),"/").concat(e.getMonth()+1,"/").concat(e.getFullYear()," : ").concat(t.value[1])},axisPointer:{animation:!1}},xAxis:{type:"time",splitLine:{show:!1},axisLabel:{color:"#fff",fontSize:14}},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1},axisLabel:{color:"#fff",fontSize:14}},series:i};this.chart.setOption(o),this.interval1=setInterval((function(){for(var e=0;e<1;e++)t.areaData.forEach((function(e){var a=e.areaName;t.groupedData[a].shift(),t.groupedData[a].push(t.randomData(a))}));var a=Object.keys(t.groupedData).map((function(e,a){return{data:t.groupedData[e]}}));t.chart.setOption({series:a})}),5e3)}},mounted:function(){var t=this;setTimeout((function(){Array.isArray(O.PersonData)&&O.PersonData.length>0&&(t.initData=O.PersonData,t.initChart()),t.intervalId=setInterval((function(){t.initData=O.PersonData,t.groupedData={},t.areaData=[],t.areaCountMap={},t.nowtime={},t.initChart()}),15e3)}),1e3)}}),nt=at,rt=(a("77e9"),Object(g["a"])(nt,tt,et,!1,null,"7d928630",null)),it=rt.exports;function ot(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function st(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(a),!0).forEach((function(e){Object(q["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ot(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var ct={name:"BottomCharts",components:{PersonnelForecast:it},data:function(){return{config4:{data:[],color:["#00baff","#3de7c9","#fff","#ffc530","#469f4b"],radius:"65%",activeRadius:"70%"}}},methods:{updateChart:function(t){var e=t.reduce((function(t,e){return t[e.areaName]=(t[e.areaName]||0)+1,t}),{}),a=[-1,-2,0,1,2],n=Math.floor(Math.random()*a.length),r=a[n],i=Object.keys(e).map((function(t){return{name:t,value:e[t]+r<0?e[t]+r+2:e[t]+r}}));this.config4.data=i,this.config4=st({},this.config4)}},mounted:function(){var t=this;setTimeout((function(){Array.isArray(O.PersonData)&&O.PersonData.length>0&&t.updateChart(O.PersonData),t.intervalId=setInterval((function(){t.updateChart(O.PersonData)}),1e4)}),1e3)}},ut=ct,lt=(a("b08f"),Object(g["a"])(ut,Q,Z,!1,null,null,null)),ft=lt.exports,dt=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"ranking-board"}},[e("div",{staticClass:"ranking-board-title"},[t._v("人员密度分布")]),e("dv-scroll-ranking-board",{attrs:{config:t.config}})],1)},ht=[];function pt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function vt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(a),!0).forEach((function(e){Object(q["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):pt(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var gt={name:"RankingBoard",data:function(){return{config:{data:[],rowNum:4}}},mounted:function(){var t=this;setTimeout((function(){Array.isArray(O.PersonData)&&O.PersonData.length>0&&t.updateChart(O.PersonData),t.intervalId=setInterval((function(){t.updateChart(O.PersonData)}),1e4)}),1e3)},methods:{updateChart:function(t){var e=t.reduce((function(t,e){return t[e.areaName]=(t[e.areaName]||0)+1,t}),{}),a=Object.keys(e).map((function(t){return{name:t,value:e[t]}}));console.log(a),this.config.data=a,this.config=vt({},this.config)}}},mt=gt,bt=(a("c1e6"),Object(g["a"])(mt,dt,ht,!1,null,null,null)),Ct=bt.exports,yt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-right-cmp"},[e("div",{staticClass:"chart-name"},[e("div",{staticClass:"lc1-header"},[t._v("区域碳排放")]),e("dv-decoration-3",{staticStyle:{width:"200px",height:"20px"}})],1),e("dv-charts",{staticClass:"carbon-emissions",attrs:{option:t.option}})],1)},Dt=[],Ot={name:"TopRightCmp",data:function(){return{option:{legend:{data:[{name:"区域1",color:"#ff5ca9"},{name:"区域2",color:"#00db95"}],textStyle:{fill:"#fff"},top:"18%"},xAxis:{data:["10/01","10/02","10/03","10/04","10/05","10/06","10/07"],axisLine:{style:{stroke:"#fff"}},axisLabel:{style:{fill:"#fff"},color:"#fff",fontSize:14},axisTick:{show:!1}},yAxis:{data:"value",splitLine:{show:!1},axisLine:{style:{stroke:"#fff"}},axisLabel:{style:{fill:"#fff"},color:"#fff",fontSize:14},axisTick:{show:!1},min:0,max:8},series:[{name:"区域1",data:[2.5,3.5,6.5,6.5,7.5,6.5,2.5],type:"line",lineStyle:{stroke:"#ff5ca9"},lineArea:{show:!0,gradient:["rgba(255, 92, 169, 0.6)","rgba(255, 92, 169, 0)"]},linePoint:{radius:4,style:{fill:"#ff5ca9",stroke:"transparent"}}},{name:"区域2",data:[1.3,2.3,5.3,5.3,6.3,5.3,1.3],type:"line",smooth:!0,lineArea:{show:!0,gradient:["rgba(55, 162, 218, 0.6)","rgba(55, 162, 218, 0)"]},lineStyle:{lineDash:[5,5],stroke:"#00db95"},linePoint:{radius:4,style:{fill:"#00db95",stroke:"transparent"}}}]}}}},wt=Ot,Pt=(a("a24c"),Object(g["a"])(wt,yt,Dt,!1,null,null,null)),xt=Pt.exports,jt=a("d4ec"),kt=a("bee2"),_t=function(){function t(e){Object(jt["a"])(this,t),this.url=e,this.ws=null,this.isConnected=!1}return Object(kt["a"])(t,[{key:"connect",value:function(t){var e=this;this.ws=new WebSocket(this.url),this.ws.onopen=function(){console.log("WebSocket 连接成功"),e.isConnected=!0,t&&t()},this.ws.onmessage=function(t){e.handleMessage&&e.handleMessage(t.data)},this.ws.onclose=function(){e.isConnected=!1,console.warn("WebSocket 连接已关闭")},this.ws.onerror=function(t){console.error("WebSocket 错误: ",t)}}},{key:"sendMessage",value:function(t){this.isConnected?(this.ws.send(t),console.log("消息已发送: ",t)):console.warn("WebSocket 连接尚未建立，无法发送消息")}},{key:"close",value:function(){this.ws&&this.ws.close()}}])}(),St={name:"DataView",components:{CenterCmp:W,PersonDistributePie:B,PersonDistributeExcel:K,BottomCharts:ft,PersonDensity:Ct,TopRightCmp:xt},data:function(){return{}},methods:{startDataFetchInterval:function(t){var e=this;this.intervalId=setInterval((function(){e.getPersonDistributionPieWs(t)}),1e3)},reqDataConvertThisData:function(t){Array.isArray(t)?O.PersonData=t:console.error("Expected data to be an array:",t)},getPersonDistributionPieWs:function(t){var e=this;t.isConnected?t.sendMessage("给我人员列表数据"):console.warn("WebSocket 连接尚未建立"),t.handleMessage=function(t){var a=JSON.parse(t);e.reqDataConvertThisData(a.rows)}}},mounted:function(){var t=this,e=new _t("ws://120.27.111.189:7070/personDistributionDonutCWs");e.connect((function(){t.getPersonDistributionPieWs(e),t.startDataFetchInterval(e)}))}},Nt=St,Mt=(a("4886"),Object(g["a"])(Nt,o,s,!1,null,null,null)),At=Mt.exports,Lt={name:"app",components:{datav:At},data:function(){return{}}},It=Lt,Wt=(a("b0ee"),Object(g["a"])(It,r,i,!1,null,null,null)),Tt=Wt.exports,Yt=(a("1395"),a("6c29")),Xt=a("5c96"),Et=a.n(Xt);a("0fae");n["default"].config.productionTip=!1,n["default"].use(Yt["a"]),n["default"].use(Et.a),new n["default"]({render:function(t){return t(Tt)}}).$mount("#app")},"59c3":function(t,e,a){},"720f":function(t,e,a){},"77e9":function(t,e,a){"use strict";a("59c3")},"9fea":function(t,e,a){},a24c:function(t,e,a){"use strict";a("55b3")},aaf0:function(t,e,a){},b08f:function(t,e,a){"use strict";a("720f")},b0ee:function(t,e,a){"use strict";a("fb86")},c1e6:function(t,e,a){"use strict";a("9fea")},fb86:function(t,e,a){}},[[0,"runtime","chunk-elementUI","chunk-libs"]]]);
//# sourceMappingURL=app.94aa75cb.js.map